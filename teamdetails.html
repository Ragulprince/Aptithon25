<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Details</title>
    
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Google Font - Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        /* General Styling */
        body {
            background-color: #000; /* Black background */
            color: #fff; /* White text */
            font-family: 'Poppins', sans-serif; /* Modern font */
        }

        /* Card Styling with Neon Effect */
        .team-card {
            background-color: #000; /* Black background */
            border: 1px solid #00bfff; /* Light Blue border */
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0, 191, 255, 0.3);
            transition: 0.3s ease-in-out;
        }

        /* Neon Hover Effect */
        .team-card:hover {
            box-shadow: 0 0 15px #00bfff, 0 0 30px #00bfff;
            transform: scale(1.03);
        }

        /* Card Header */
        .team-card .card-header {
            background-color: #00bfff; /* Light Blue */
            color: #000; /* Black text */
            font-weight: bold;
            border-radius: 10px 10px 0 0;
            text-align: center;
        }

        /* Card Body */
        .team-card .card-body {
            padding: 20px;
            color: #fff; /* White text for contrast */
        }

        /* List Items */
        .team-card .list-group-item {
            background-color: transparent; /* Transparent background */
            border: none;
            padding: 10px 0;
            color: #fff; /* White text */
        }

        .team-card .list-group-item strong {
            color: #00bfff; /* Light Blue for emphasis */
        }

        /* Search Input */
        #searchInput {
            background-color: #222;
            border: 1px solid #00bfff;
            color: #fff;
        }

        #searchInput::placeholder {
            color: #aaa;
        }

        /* Team Details Button */
        .team-details-btn {
            border: 2px solid #00bfff;
            color: #00bfff;
            transition: 0.3s ease-in-out;
        }

        .team-details-btn:hover {
            background-color: #00bfff;
            color: #000;
        }
    </style>

    <script>
        let teamsData = {};

        // Fetch JSON data with error handling
        fetch('team_details.json')
            .then(response => response.json())
            .then(data => {
                try {
                    // Ensure no NaN values and handle unexpected tokens
                    Object.keys(data).forEach(teamNo => {
                        data[teamNo] = data[teamNo].map(member => ({
                            ...member,
                            "S.No": isNaN(member["S.No"]) || member["S.No"] === null ? 0 : member["S.No"]
                        }));
                    });
                    teamsData = data;
                    displayTeams(data);
                } catch (error) {
                    console.error("Error processing JSON data:", error);
                }
            })
            .catch(error => {
                console.error("Error fetching team details:", error);
            });

        function displayTeams(data) {
            let container = document.getElementById("teamList");
            container.innerHTML = "";
            Object.keys(data).forEach(teamNo => {
                let team = data[teamNo];
                let teamHTML = `
                    <div class='team-card card'>
                        <div class='card-header'>Team ${teamNo}</div>
                        <div class='card-body'>
                            <ul class='list-group'>`;
                team.forEach(member => {
                    teamHTML += `
                        <li class='list-group-item'>
                            <strong>${member['Student Name']}</strong> - ${member.Class} <br>
                            Reg: ${member['Reg. No']} | Mobile: ${member['Mobile No']}
                        </li>`;
                });
                teamHTML += `
                            </ul>
                        </div>
                    </div>`;
                container.innerHTML += teamHTML;
            });
            localStorage.setItem("teamDetails", JSON.stringify(data));
        }

        function searchTeams() {
            let query = document.getElementById("searchInput").value.toLowerCase();
            let filteredTeams = {};
            
            Object.keys(teamsData).forEach(teamNo => {
                let teamNumberStr = teamNo.toString(); // Convert team number to string
                let team = teamsData[teamNo].filter(member =>
                    teamNumberStr.includes(query) ||  // Fixed team number search
                    member['Student Name'].toLowerCase().includes(query) || 
                    member['Reg. No'].toString().includes(query) || 
                    member['Mobile No'].toString().includes(query)
                );

                if (team.length > 0) {
                    filteredTeams[teamNo] = team;
                }
            });

            displayTeams(filteredTeams);
        }
    </script>
</head>
<body class="container mt-4">
    <a href="index.html" class="btn btn-secondary">Back</a>
    <h2 class="text-center text-info">Team Details</h2> <!-- Light Blue text for heading -->
    
    <!-- Search Box -->
    <input type="text" id="searchInput" class="form-control mb-4" placeholder="Search by Team No, Name, Reg No, Phone..." onkeyup="searchTeams()">
    
    <!-- Team List -->
    <div id="teamList"></div>
</body>
</html>